<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<header>
    <div th:replace="~{fragments/header :: header}"></div>
    <meta name="_csrf" th:content="${_csrf.token}"/>
    <meta name="_csrf_header" th:content="${_csrf.headerName}"/>
<style>
    table {
    width: 100%;
    margin-top: 20px;
    border-collapse: collapse;
}

th, td {
    padding: 10px;
    border: 1px solid #ddd;
    text-align: left;
}

th {
    background-color: #9aa4ec;
    color: white;
}


.table-wrapper {
  display: flex;
  flex-wrap: wrap;
}

table {
  flex: 1 0 50%; /* This will make tables take up 50% of the wrapper's width */
  box-sizing: border-box;
  padding: 1em;
}

@media screen and (max-width: 600px) {
  table {
    flex: 1 0 100%; /* On screens smaller than 600px, tables take up 100% of the width */
  }
}
.red {
    color: red;
}

.green {
    color: green;
        font-weight: bold;
}

.purple {
    color: #6474e5;
    font-weight: bold;
}

</style>
</header>
<body>
<div th:replace="~{fragments/navbar :: navbar}"></div>
<div class="form" style="display: flex; justify-content: center; align-items: center;">
        <form th:action="@{/savings/goals}" th:object="${goal}" method="post" style="display: flex; justify-content: center; align-items: center; gap: 2rem;">
        <h2>Create New Goal</h2>
        <div class="form-row" style="width:20rem;">
            <input type="text" placeholder="name of goal" id="name" th:field="*{name}" class="form-control" required>
        </div>
        <div class="form-row" style="width:20rem;">
            <input type="text" placeholder="description" id="description" th:field="*{description}" class="form-control" required>
        </div>
        <div class="form-row" style="width:20rem;">
            <input type="number" id="maxAmount" th:field="*{maxAmount}" step="0.01" class="form-control" required>
        </div>
        <button type="submit" class="myButton">Create</button>
    </form>
</div>

<h2>Savings Goals List</h2>
<table>
    <colgroup>
        <col style="width: 10%">
        <col style="width: 25%">
        <col style="width: 5%">
        <col style="width: 10%">
        <col style="width: 5%">
    </colgroup>
    <thead>
    <tr class="header">
        <th>Name</th>
        <th>Description</th>
        <th>Goal Amount</th>
        <th>Saved till now</th>
        <th>Reached</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="goal : ${goals}">
        <td data-title="Goal">
            <a th:href="@{'/charts/savings/' + ${goal.id}}" th:text="${goal.name}"></a>
        </td>
        <td data-title="Description" th:text="${goal.description}"></td>
        <td data-title="Goal Amount" th:text="${goal.maxAmount}"></td>
        <td data-title="Saved so far"
            th:class="${goal.lastAmount < goal.maxAmount} ? 'red' :
              (__${goal.lastAmount}__ == __${goal.maxAmount}__ ? 'green' : 'purple')"
            th:text="${goal.lastAmount}">
        </td>
        <td data-title="Status">
            <span th:if="${goal.reached}">✔</span>
            <span th:unless="${goal.reached}">❌</span>
        </td>
    </tr>

    </tbody>
</table>

<h3>Savings</h3>
<div class="table-wrapper">
<table>
    <thead>
    <tr>
        <th>Goal</th>
        <th>Date</th>
        <th>amount</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="saving : ${savings}">
        <td th:text="${saving.goal.name}"></td>
        <td th:text="${saving.monthYear}"></td>
        <th th:text="${saving.amount}"></th>
    </tr>
    </tbody>
</table>
</div>

</body>
</html>
